
libname mods 'f:\Uni\Projects\P020_Temprature_NE_MIA\3.Work\3.Analysis\AN_001_mods\' ;

libname nexpo 'f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN029_small_expo\' ;

PROC IMPORT OUT= WORK.pmguid
            DATAFILE= "f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN007_key\nas_tempguid.dbf" 
			            DBMS=DBF   REPLACE;
						     GETDELETED=NO;
							 RUN; 

data  pmguid (drop = xnym ynym xnymx ynymx);;;
set  pmguid;
xnym=put(glong,Best12.);
   ynym=put(glat, Best12.);
   xnymx = xnym*10000;
   ynymx = ynym*10000;
   guid = compress(xnymx||ynymx);
   drop fintemp;
run;


proc summary nway data=pmguid;
 class guid;
  var Seasonal;
   output out=outputfile mean=Seasonal;
run; 


							  

PROC EXPORT DATA= outputfile
            OUTFILE= "f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN007_key\nas_tempguid_unique.csv" 
			            DBMS=CSV REPLACE;
						     PUTNAMES=YES;
							 RUN;
							  

options mprint;
%macro import(year=);

data nexpo.nasex&year;
set mods.Fintmpc_&year;
 if guid in (
"-678330461139",
"-692066445716",
"-696283438608",
"-696644438728",
"-697608443186",
"-698210443186",
"-699415444150",
"-699536417041",
"-699656416800",
"-699777416800",
"-699777416920",
"-699897417041",
"-699897417764",
"-700018416800",
"-700379416920",
"-700379417764",
"-700379419450",
"-700500416800",
"-700500419330",
"-700620412583",
"-700620416920",
"-700620420053",
"-700741416679",
"-700741417041",
"-700982412824",
"-700982417041",
"-701102412824",
"-701102416679",
"-701223416679",
"-701464417041",
"-701584416920",
"-701704416679",
"-701704416800",
"-701704417402",
"-701825416800",
"-701825417161",
"-701825417402",
"-701945437764",
"-701945438005",
"-702066416800",
"-702066416920",
"-702066417161",
"-702066417282",
"-702066417402",
"-702066420414",
"-702186416800",
"-702186417041",
"-702307416559",
"-702427416559",
"-702548416559",
"-702789416559",
"-702789417041",
"-702909436680",
"-702909436800",
"-703030416920",
"-703150416559",
"-703512416679",
"-703512416800",
"-703512439331",
"-703632416438",
"-703632416679",
"-703753416679",
"-703873416197",
"-703873416318",
"-703994416559",
"-703994416679",
"-703994435114",
"-704355416438",
"-704596416800",
"-704596417041",
"-704596417402",
"-704717415836",
"-704717416920",
"-704717417402",
"-704837417161",
"-704958415715",
"-704958416077",
"-704958417041",
"-704958417643",
"-704958435957",
"-705078415836",
"-705078416197",
"-705078417643",
"-705199417884",
"-705319413908",
"-705440418607",
"-705560418125",
"-705560418969",
"-705681415595",
"-705681416197",
"-705681419330",
"-705801415836",
"-705801418848",
"-705801433788",
"-705921433186",
"-705921434632",
"-706042426439",
"-706162415956",
"-706162416559",
"-706162416679",
"-706162417523",
"-706162432463",
"-706283415715",
"-706283417523",
"-706283419450",
"-706403415715",
"-706403417402",
"-706403418005",
"-706403426318",
"-706524431499",
"-706524434270",
"-706644417402",
"-706644420655",
"-706644426318",
"-706765421017",
"-706885419330",
"-706885420655",
"-706885420776",
"-706885420896",
"-706885421258",
"-707006420173",
"-707006420294",
"-707006421137",
"-707006421378",
"-707006426559",
"-707126417523",
"-707126425836",
"-707247417402",
"-707247417523",
"-707247419210",
"-707247419450",
"-707247419932",
"-707367417523",
"-707367417884",
"-707367419210",
"-707367419330",
"-707367420173",
"-707367420896",
"-707367421860",
"-707367421981",
"-707367422101",
"-707367433065",
"-707488420173",
"-707488421860",
"-707608420414",
"-707608421740",
"-707608430776",
"-707608434150",
"-707729420535",
"-707729425836",
"-707849429692",
"-707970416559",
"-707970422222",
"-707970426921",
"-707970431861",
"-708090416679",
"-708090417402",
"-708090420053",
"-708090420776",
"-708090422463",
"-708090429330",
"-708211416679",
"-708211420896",
"-708211422101",
"-708211426198",
"-708211427884",
"-708211428246",
"-708331421137",
"-708331422583",
"-708331426077",
"-708452415956",
"-708452419932",
"-708452422583",
"-708452427403",
"-708452428848",
"-708572415956",
"-708572416077",
"-708572416438",
"-708572420535",
"-708572421378",
"-708572421619",
"-708572422704",
"-708572425113",
"-708572426680",
"-708572426800",
"-708693416920",
"-708693418607",
"-708693418728",
"-708693421499",
"-708693422463",
"-708693431981",
"-708813416318",
"-708813416438",
"-708813421981",
"-708813422463",
"-708813424993",
"-708813425234",
"-708813425716",
"-708813425836",
"-708813428125",
"-708934416318",
"-708934416438",
"-708934417282",
"-708934419089",
"-708934421137",
"-708934421740",
"-708934422222",
"-708934424872",
"-708934425234",
"-708934425595",
"-708934425716",
"-708934425836",
"-708934426077",
"-708934428125",
"-708934431620",
"-709054416559",
"-709054416679",
"-709054416800",
"-709054417282",
"-709054421258",
"-709054423065",
"-709054425595",
"-709054425716",
"-709054426921",
"-709175418969",
"-709175420173",
"-709175421981",
"-709175422463",
"-709175424752",
"-709175425113",
"-709175425354",
"-709175426077",
"-709295416318",
"-709295416438",
"-709295416559",
"-709295416679",
"-709295416800",
"-709295416920",
"-709295418728",
"-709295420053",
"-709295421378",
"-709295421740",
"-709295422101",
"-709295422463",
"-709295424270",
"-709295424752",
"-709295425716",
"-709295426559",
"-709295431258",
"-709295436198",
"-709295440174",
"-709416416197",
"-709416416318",
"-709416416438",
"-709416416800",
"-709416416920",
"-709416417041",
"-709416417161",
"-709416417282",
"-709416418969",
"-709416420053",
"-709416420655",
"-709416420776",
"-709416420896",
"-709416421017",
"-709416421258",
"-709416421378",
"-709416421619",
"-709416421740",
"-709416422101",
"-709416422222",
"-709416422342",
"-709416424752",
"-709416425234",
"-709416425354",
"-709416425595",
"-709416425957",
"-709416426800",
"-709416429812",
"-709416430656",
"-709536416197",
"-709536416318",
"-709536416438",
"-709536416559",
"-709536417282",
"-709536418607",
"-709536419812",
"-709536421378",
"-709536421981",
"-709536422222",
"-709536422463",
"-709536424631",
"-709536424752",
"-709536424872",
"-709536425354",
"-709536435957",
"-709657416438",
"-709657416800",
"-709657418848",
"-709657419932",
"-709657420053",
"-709657421378",
"-709657421619",
"-709657421860",
"-709657422101",
"-709657422222",
"-709657424631",
"-709657425475",
"-709657427403",
"-709657429692",
"-709777415956",
"-709777419812",
"-709777419932",
"-709777420655",
"-709777422222",
"-709777422463",
"-709777422583",
"-709777424511",
"-709777424631",
"-709777425475",
"-709777425836",
"-709777429812",
"-709777430776",
"-709898420053",
"-709898420173",
"-709898421499",
"-709898421740",
"-709898422342",
"-709898422463",
"-709898424511",
"-709898428728",
"-710018420173",
"-710018421137",
"-710018421258",
"-710018421740",
"-710018421860",
"-710018422101",
"-710018422222",
"-710018422463",
"-710018422704",
"-710018423667",
"-710018423908",
"-710018424029",
"-710018424511",
"-710018425595",
"-710018427282",
"-710018427884",
"-710138416318",
"-710138420776",
"-710138421137",
"-710138421378",
"-710138421499",
"-710138421619",
"-710138421740",
"-710138421981",
"-710138422101",
"-710138422463",
"-710138422583",
"-710138422704",
"-710138423908",
"-710138424029",
"-710138424149",
"-710138424511",
"-710138424631",
"-710138424752",
"-710138424872",
"-710138425234",
"-710138425354",
"-710259420173",
"-710259420294",
"-710259420535",
"-710259420655",
"-710259420896",
"-710259421017",
"-710259421619",
"-710259421981",
"-710259422342",
"-710259422463",
"-710259422583",
"-710259422704",
"-710259422824",
"-710259423908",
"-710259424029",
"-710259424149",
"-710259424270",
"-710259424752",
"-710259425475",
"-710379420535",
"-710379420655",
"-710379420776",
"-710379420896",
"-710379421017",
"-710379421137",
"-710379421258",
"-710379421619",
"-710379421740",
"-710379422583",
"-710379422704",
"-710379422824",
"-710379424029",
"-710379424752",
"-710379425113",
"-710379425836",
"-710379428487",
"-710379428969",
"-710379433186",
"-710500420535",
"-710500420896",
"-710500421017",
"-710500421499",
"-710500421740",
"-710500421860",
"-710500422463",
"-710500422583",
"-710500422824",
"-710500422945",
"-710500423427",
"-710500423667",
"-710500423788",
"-710500423908",
"-710500424029",
"-710500424149",
"-710500424390",
"-710500424511",
"-710500424631",
"-710500425475",
"-710620420655",
"-710620420776",
"-710620421378",
"-710620421860",
"-710620421981",
"-710620422342",
"-710620422463",
"-710620422583",
"-710620422704",
"-710620422824",
"-710620423186",
"-710620423306",
"-710620423667",
"-710620423788",
"-710620424029",
"-710620424149",
"-710620424511",
"-710620424631",
"-710620424752",
"-710620425354",
"-710620425595",
"-710620428125",
"-710741415956",
"-710741420294",
"-710741420896",
"-710741422342",
"-710741422463",
"-710741422583",
"-710741422704",
"-710741422945",
"-710741423186",
"-710741423427",
"-710741423547",
"-710741423788",
"-710741424029",
"-710741424270",
"-710741424390",
"-710741424511",
"-710741424631",
"-710741424752",
"-710741424872",
"-710741433909",
"-710861420414",
"-710861420535",
"-710861421017",
"-710861421137",
"-710861421258",
"-710861422463",
"-710861422583",
"-710861422704",
"-710861422824",
"-710861422945",
"-710861423186",
"-710861423547",
"-710861423908",
"-710861424029",
"-710861424149",
"-710861424390",
"-710861424511",
"-710861424993",
"-710861425113",
"-710982419330",
"-710982420173",
"-710982420414",
"-710982420535",
"-710982420776",
"-710982421499",
"-710982422463",
"-710982422583",
"-710982422704",
"-710982423427",
"-710982423667",
"-710982423788",
"-710982423908",
"-710982424029",
"-710982424149",
"-710982424270",
"-710982424752",
"-710982424872",
"-710982424993",
"-710982425113",
"-710982426800",
"-710982427884",
"-710982428125",
"-711102420414",
"-711102420655",
"-711102420896",
"-711102421258",
"-711102421740",
"-711102422463",
"-711102422824",
"-711102423065",
"-711102423306",
"-711102423427",
"-711102423547",
"-711102424029",
"-711102424270",
"-711102424752",
"-711102424872",
"-711102424993",
"-711102425113",
"-711102425354",
"-711102425475",
"-711102425595",
"-711102425836",
"-711102427041",
"-711223417282",
"-711223419210",
"-711223420414",
"-711223420896",
"-711223421981",
"-711223422222",
"-711223422342",
"-711223422463",
"-711223422583",
"-711223422704",
"-711223422824",
"-711223423065",
"-711223423306",
"-711223423427",
"-711223423908",
"-711223424149",
"-711223424270",
"-711223424631",
"-711223424872",
"-711223425113",
"-711223426921",
"-711223438126",
"-711343416920",
"-711343418607",
"-711343419210",
"-711343421258",
"-711343421378",
"-711343421981",
"-711343422583",
"-711343422704",
"-711343422824",
"-711343422945",
"-711343423306",
"-711343424029",
"-711343424149",
"-711343424270",
"-711343424390",
"-711343424511",
"-711343424631",
"-711343424752",
"-711343427644",
"-711343427764",
"-711343427884",
"-711343436559",
"-711464420535",
"-711464421378",
"-711464421499",
"-711464421619",
"-711464421740",
"-711464422222",
"-711464422342",
"-711464422583",
"-711464422704",
"-711464422824",
"-711464422945",
"-711464423065",
"-711464423306",
"-711464424029",
"-711464424149",
"-711464424270",
"-711464424390",
"-711464424631",
"-711464424752",
"-711464424872",
"-711464426559",
"-711464427282",
"-711464427403",
"-711464428607",
"-711584416679",
"-711584417041",
"-711584421137",
"-711584421378",
"-711584421499",
"-711584421619",
"-711584422222",
"-711584422342",
"-711584422463",
"-711584422583",
"-711584422704",
"-711584422824",
"-711584422945",
"-711584423065",
"-711584423427",
"-711584423547",
"-711584424029",
"-711584424149",
"-711584424390",
"-711584424511",
"-711584424752",
"-711584425595",
"-711584430053",
"-711705418728",
"-711705420294",
"-711705421017",
"-711705421499",
"-711705421740",
"-711705422342",
"-711705422463",
"-711705422583",
"-711705422704",
"-711705423667",
"-711705423908",
"-711705424149",
"-711705424270",
"-711705424511",
"-711705425716",
"-711705427523",
"-711705428607",
"-711825416800",
"-711825421258",
"-711825421740",
"-711825421860",
"-711825422222",
"-711825422342",
"-711825422463",
"-711825422945",
"-711825423065",
"-711825423186",
"-711825423547",
"-711825423667",
"-711825423788",
"-711825424029",
"-711825424149",
"-711825424270",
"-711825424390",
"-711825424511",
"-711825426318",
"-711825426680",
"-711946416077",
"-711946421740",
"-711946421860",
"-711946421981",
"-711946422101",
"-711946422222",
"-711946423547",
"-711946423788",
"-711946423908",
"-711946424029",
"-711946424149",
"-711946424993",
"-711946425234",
"-711946425354",
"-711946427644",
"-712066420655",
"-712066421499",
"-712066421740",
"-712066421860",
"-712066421981",
"-712066422463",
"-712066422704",
"-712066423065",
"-712066423186",
"-712066423306",
"-712066423547",
"-712066423667",
"-712066423908",
"-712066424872",
"-712066425113",
"-712066425595",
"-712066427523",
"-712187419812",
"-712187420776",
"-712187421499",
"-712187421619",
"-712187421740",
"-712187421860",
"-712187423186",
"-712187423306",
"-712187423547",
"-712187423667",
"-712187423788",
"-712187424149",
"-712187424993",
"-712187425836",
"-712187426077",
"-712187426439",
"-712187426680",
"-712187427764",
"-712307420294",
"-712307420414",
"-712307420655",
"-712307421499",
"-712307421619",
"-712307421740",
"-712307421860",
"-712307422101",
"-712307422824",
"-712307422945",
"-712307423065",
"-712307423547",
"-712307424149",
"-712307424390",
"-712307425836",
"-712307425957",
"-712307427162",
"-712307428969",
"-712307435837",
"-712428421258",
"-712428421981",
"-712428422101",
"-712428423306",
"-712428423427",
"-712428424029",
"-712428424149",
"-712428424511",
"-712428425475",
"-712548420535",
"-712548421137",
"-712548422945",
"-712548423427",
"-712548424149",
"-712548424390",
"-712548424752",
"-712548424993",
"-712548425354",
"-712548425475",
"-712548425595",
"-712548425836",
"-712669421378",
"-712669423427",
"-712669423667",
"-712669423788",
"-712669424752",
"-712669425113",
"-712669425595",
"-712789414993",
"-712789420776",
"-712789421860",
"-712789422945",
"-712789425595",
"-712910421740",
"-712910421860",
"-712910422945",
"-712910423065",
"-712910424872",
"-712910425595",
"-713030420053",
"-713030421860",
"-713030421981",
"-713030423065",
"-713030424149",
"-713030428366",
"-713151414872",
"-713151420655",
"-713151421981",
"-713151423186",
"-713151426439",
"-713151427644",
"-713151428728",
"-713271419691",
"-713271419812",
"-713271420053",
"-713271421017",
"-713271422463",
"-713271422704",
"-713271423065",
"-713271423186",
"-713271424029",
"-713271425836",
"-713392421740",
"-713392421860",
"-713392422704",
"-713392423065",
"-713392424029",
"-713392425113",
"-713392425716",
"-713392426198",
"-713392426800",
"-713512421619",
"-713512421860",
"-713512422704",
"-713512422824",
"-713512423065",
"-713512423186",
"-713512425234",
"-713512425957",
"-713512426198",
"-713512426800",
"-713633418969",
"-713633421740",
"-713633423065",
"-713633423186",
"-713633424511",
"-713753421017",
"-713753422945",
"-713753424511",
"-713753425957",
"-713753435716",
"-713874422824",
"-713874426198",
"-713994421137",
"-713994421258",
"-713994422704",
"-713994422824",
"-713994422945",
"-713994423065",
"-713994423186",
"-713994425475",
"-713994426439",
"-713994428848",
"-713994438728",
"-714115422824",
"-714115422945",
"-714115423065",
"-714115423186",
"-714115423306",
"-714115424631",
"-714115426077",
"-714235420535",
"-714235422342",
"-714235422704",
"-714235422824",
"-714235422945",
"-714235423065",
"-714235423306",
"-714356414872",
"-714356417643",
"-714356421017",
"-714356421258",
"-714356421378",
"-714356422342",
"-714356422704",
"-714356422945",
"-714356423186",
"-714356423306",
"-714356423427",
"-714356423547",
"-714356428969",
"-714356429692",
"-714356435355",
"-714476422945",
"-714476423306",
"-714476424149",
"-714476424511",
"-714476435596",
"-714476435716",
"-714596422222",
"-714596422463",
"-714596422704",
"-714596422945",
"-714596424390",
"-714596427162",
"-714596427884",
"-714717416438",
"-714717420414",
"-714717421258",
"-714717421740",
"-714717421860",
"-714717427162",
"-714717427403",
"-714717427884",
"-714717429812",
"-714837420053",
"-714837420173",
"-714837420414",
"-714837421137",
"-714837422824",
"-714837423306",
"-714837427764",
"-714958416438",
"-714958428366",
"-714958429571",
"-714958429692",
"-714958432222",
"-715078414631",
"-715078422342",
"-715078427644",
"-715078432222",
"-715199421378",
"-715199424752",
"-715199425354",
"-715319421378",
"-715319421499",
"-715319421619",
"-715319423427",
"-715440420053",
"-715440423788",
"-715440426198",
"-715440427523",
"-715681418728",
"-715681420655",
"-715681422583",
"-715681426077",
"-715681427403",
"-715681432945",
"-715801421981",
"-715801423427",
"-715801429451",
"-715922423908",
"-715922434270",
"-715922446801",
"-716042422704",
"-716042422824",
"-716163420896",
"-716163426198",
"-716163426439",
"-716283422342",
"-716283428728",
"-716404421499",
"-716524422945",
"-716524423667",
"-716524427884",
"-716765423427",
"-716765426439",
"-716886421619",
"-717127424270",
"-717247424270",
"-717729421499",
"-717729421740",
"-717729425475",
"-717850424631",
"-718332422101",
"-718332422824",
"-718332422945",
"-718332425957",
"-718332435234",
"-718452422463",
"-719416425354",
"-719777421378",
"-720018444271",
"-720139444271",
"-720862421137",
"-721464429330",
"-722067421258",
"-722549417764",
"-722669429330",
"-723151432101",
"-723753438608",
"-724356449451",
"-725320416559",
"-725320417282",
"-725320421137",
"-725440417161",
"-725681424993",
"-726043425957",
"-726043426077",
"-726404422704",
"-726645415956",
"-727488412703",
"-727729412944",
"-727970412703",
"-728091412703",
"-728452425113",
"-728573413908",
"-731344411619",
"-731946416800",
"-731946444753",
"-733513441258",
"-733995411016",
"-733995439692"
);
run;



%MEND ;

%import(year=2000);
%import(year=2001);
%import(year=2002);
%import(year=2003);
%import(year=2004);
%import(year=2005);
%import(year=2006);
%import(year=2007);
%import(year=2008); 
%import(year=2009);
%import(year=2010);
%import(year=2011);






data nexpo.tall;
set nexpo.Nasex2000 nexpo.Nasex2001 nexpo.Nasex2002 nexpo.Nasex2003 nexpo.Nasex2004 nexpo.Nasex2005 nexpo.Nasex2006 nexpo.Nasex2007 nexpo.Nasex2008 nexpo.Nasex2009 nexpo.Nasex2010  nexpo.Nasex2011  ;
run; 

proc means data=nexpo.tall n mean nmiss;
var fintemp; 
run; 


libname exp 'f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN031_exposure\' ;

data exp.pollnolag;
set nexpo.tall;
run; 











