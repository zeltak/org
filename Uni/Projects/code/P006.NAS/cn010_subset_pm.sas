
libname mods 'f:\Uni\Projects\3.1.1.NE_PM_MODELS\3.1.1.4.Work\3.Analysis\AN039_Final_poll_datasets\' ;

libname nexpo 'f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN029_pm10_expo\' ;

PROC IMPORT OUT= WORK.pmguid
            DATAFILE= "f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN007_key\nas_PM10x10guid.dbf" 
			            DBMS=DBF   REPLACE;
						     GETDELETED=NO;
							 RUN; 



proc summary nway data=pmguid;
 class guid;
  var Seasonal;
   output out=outputfile mean=Seasonal;
run; 


							  

PROC EXPORT DATA= outputfile
            OUTFILE= "f:\Uni\Projects\3.1.6.NAS\3.1.6.4.Work\2.Gather_data\FN007_key\nas_pm10x10guid_unique.csv" 
			            DBMS=CSV REPLACE;
						     PUTNAMES=YES;
							 RUN;
							  

options mprint;
%macro import(year=);

data nexpo.nasex&year;
set mods.poll_0008;
 if guid in (
"67854615",
"69254455",
"69654385",
"69754435",
"69854435",
"69954165",
"69954175",
"69954445",
"70054125",
"70054165",
"70054175",
"70054195",
"70154125",
"70154165",
"70154175",
"70154205",
"70154375",
"70154385",
"70254165",
"70254365",
"70354165",
"70354355",
"70354395",
"70454155",
"70454165",
"70454175",
"70554135",
"70554155",
"70554165",
"70554175",
"70554185",
"70554195",
"70554335",
"70554345",
"70554365",
"70654155",
"70654165",
"70654175",
"70654195",
"70654205",
"70654215",
"70654265",
"70654315",
"70654325",
"70654345",
"70754165",
"70754175",
"70754195",
"70754205",
"70754215",
"70754225",
"70754255",
"70754305",
"70754335",
"70754345",
"70854165",
"70854175",
"70854185",
"70854195",
"70854205",
"70854215",
"70854225",
"70854245",
"70854255",
"70854265",
"70854275",
"70854285",
"70854295",
"70854315",
"70954165",
"70954175",
"70954185",
"70954195",
"70954205",
"70954215",
"70954225",
"70954245",
"70954255",
"70954265",
"70954275",
"70954285",
"70954295",
"70954305",
"70954315",
"70954355",
"70954365",
"70954405",
"71054155",
"71054165",
"71054205",
"71054215",
"71054225",
"71054235",
"71054245",
"71054255",
"71054265",
"71054275",
"71054285",
"71054335",
"71154165",
"71154175",
"71154185",
"71154195",
"71154205",
"71154215",
"71154225",
"71154235",
"71154245",
"71154255",
"71154265",
"71154275",
"71154285",
"71154305",
"71154365",
"71154385",
"71254155",
"71254195",
"71254205",
"71254215",
"71254225",
"71254235",
"71254245",
"71254255",
"71254265",
"71254275",
"71254295",
"71254355",
"71354145",
"71354185",
"71354195",
"71354205",
"71354215",
"71354225",
"71354235",
"71354245",
"71354255",
"71354265",
"71354275",
"71354285",
"71354355",
"71354385",
"71454145",
"71454165",
"71454175",
"71454205",
"71454215",
"71454225",
"71454235",
"71454245",
"71454265",
"71454275",
"71454285",
"71454295",
"71454325",
"71454355",
"71554145",
"71554185",
"71554205",
"71554215",
"71554225",
"71554235",
"71554245",
"71554255",
"71554265",
"71554275",
"71554295",
"71554325",
"71554345",
"71554465",
"71654205",
"71654215",
"71654225",
"71654235",
"71654265",
"71654275",
"71654285",
"71754215",
"71754245",
"71754255",
"71854225",
"71854255",
"71854355",
"71954215",
"71954255",
"72054215",
"72054445",
"72154295",
"72254175",
"72254215",
"72254295",
"72354325",
"72354385",
"72454495",
"72554165",
"72554175",
"72554215",
"72554255",
"72654165",
"72654225",
"72654265",
"72754125",
"72854135",
"72854255",
"73154115",
"73154165",
"73154445",
"73354395",
"73354415",
"73454115"
);
run;



%MEND ;

%import(year=2000);
%import(year=2001);
%import(year=2002);
%import(year=2003);
%import(year=2004);
%import(year=2005);
%import(year=2006);
%import(year=2007);
%import(year=2008); 
%import(year=2009);
%import(year=2010);
%import(year=2011);






data nexpo.tall;
set nexpo.Nasex2000 nexpo.Nasex2001 nexpo.Nasex2002 nexpo.Nasex2003 nexpo.Nasex2004 nexpo.Nasex2005 nexpo.Nasex2006 nexpo.Nasex2007 nexpo.Nasex2008 nexpo.Nasex2009 nexpo.Nasex2010  nexpo.Nasex2011  ;
run; 

proc means data=nexpo.tall n mean nmiss;
var pmnew; 
run; 













