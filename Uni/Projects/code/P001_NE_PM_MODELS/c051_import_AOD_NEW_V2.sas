PROC IMPORT OUT= grid
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\3.Analysis\AN005_mod3\uniq_grid.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=YES;
	    DATAROW=2; 
		RUN;
		 

		
options mprint;
%macro import(day=);


PROC IMPORT OUT= T2009&day
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.4.Resources\DATA\MODIS USA\2009\MOD04_L2.A2009&day..table.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=NO;
	    DATAROW=2; 
		RUN;
		 

data T2009&day(drop=var1 var2 var3 var4 var5 var6);
set T2009&day;
date=Var2;
format DATE  DATE9.;
Long_aod=var4;
Lat_aod=var5;
AOD=var6/1000;
run; 


proc sort data = grid;       by long_aod lat_aod   ;run;
proc sort data = T2009&day ; by long_aod lat_aod ;run;

data T2009&day;
merge grid(in=a) T2009&day (in=b)  ;
  by long_aod lat_aod;
    if a;
	run; 

PROC APPEND
     BASE = AOD2009
     DATA = T2009&day;
RUN ;

proc datasets lib = work; delete T2009&day; run;

%mend;

%import(day=	001	);
%import(day=	002	);
%import(day=	003	);
%import(day=	004	);
%import(day=	005	);
%import(day=	006	);
%import(day=	007	);
%import(day=	008	);
%import(day=	009	);
%import(day=	010	);
%import(day=	011	);
%import(day=	012	);
%import(day=	013	);
%import(day=	014	);
%import(day=	015	);
%import(day=	016	);
%import(day=	017	);
%import(day=	018	);
%import(day=	019	);
%import(day=	020	);
%import(day=	021	);
%import(day=	022	);
%import(day=	023	);
%import(day=	024	);
%import(day=	025	);
%import(day=	026	);
%import(day=	027	);
%import(day=	028	);
%import(day=	029	);
%import(day=	030	);
%import(day=	031	);
%import(day=	032	);
%import(day=	033	);
%import(day=	034	);
%import(day=	035	);
%import(day=	036	);
%import(day=	037	);
%import(day=	038	);
%import(day=	039	);
%import(day=	040	);
%import(day=	041	);
%import(day=	042	);
%import(day=	043	);
%import(day=	044	);
%import(day=	045	);
%import(day=	046	);
%import(day=	047	);
%import(day=	048	);
%import(day=	049	);
%import(day=	050	);
%import(day=	051	);
%import(day=	052	);
%import(day=	053	);
%import(day=	054	);
%import(day=	055	);
%import(day=	056	);
%import(day=	057	);
%import(day=	058	);
%import(day=	059	);
%import(day=	060	);
%import(day=	061	);
%import(day=	062	);
%import(day=	063	);
%import(day=	064	);
%import(day=	065	);
%import(day=	066	);
%import(day=	067	);
%import(day=	068	);
%import(day=	069	);
%import(day=	070	);
%import(day=	071	);
%import(day=	072	);
%import(day=	073	);
%import(day=	074	);
%import(day=	075	);
%import(day=	076	);
%import(day=	077	);
%import(day=	078	);
%import(day=	079	);
%import(day=	080	);
%import(day=	081	);
%import(day=	082	);
%import(day=	083	);
%import(day=	084	);
%import(day=	085	);
%import(day=	086	);
%import(day=	087	);
%import(day=	088	);
%import(day=	089	);
%import(day=	090	);
%import(day=	091	);
%import(day=	092	);
%import(day=	093	);
%import(day=	094	);
%import(day=	095	);
%import(day=	096	);
%import(day=	097	);
%import(day=	098	);
%import(day=	099	);
%import(day=	100	);
%import(day=	101	);
%import(day=	102	);
%import(day=	103	);
%import(day=	104	);
%import(day=	105	);
%import(day=	106	);
%import(day=	107	);
%import(day=	108	);
%import(day=	109	);
%import(day=	110	);
%import(day=	111	);
%import(day=	112	);
%import(day=	113	);
%import(day=	114	);
%import(day=	115	);
%import(day=	116	);
%import(day=	117	);
%import(day=	118	);
%import(day=	119	);
%import(day=	120	);
%import(day=	121	);
%import(day=	122	);
%import(day=	123	);
%import(day=	124	);
%import(day=	125	);
%import(day=	126	);
%import(day=	127	);
%import(day=	128	);
%import(day=	129	);
%import(day=	130	);
%import(day=	131	);
%import(day=	132	);
%import(day=	133	);
%import(day=	134	);
%import(day=	135	);
%import(day=	136	);
%import(day=	137	);
%import(day=	138	);
%import(day=	139	);
%import(day=	140	);
%import(day=	141	);
%import(day=	142	);
%import(day=	143	);
%import(day=	144	);
%import(day=	145	);
%import(day=	146	);
%import(day=	147	);
%import(day=	148	);
%import(day=	149	);
%import(day=	150	);
%import(day=	151	);
%import(day=	152	);
%import(day=	153	);
%import(day=	154	);
%import(day=	155	);
%import(day=	156	);
%import(day=	157	);
%import(day=	158	);
%import(day=	159	);
%import(day=	160	);
%import(day=	161	);
%import(day=	162	);
%import(day=	163	);
%import(day=	164	);
%import(day=	165	);
%import(day=	166	);
%import(day=	167	);
%import(day=	168	);
%import(day=	169	);
%import(day=	170	);
%import(day=	171	);
%import(day=	172	);
%import(day=	173	);
%import(day=	174	);
%import(day=	175	);
%import(day=	176	);
%import(day=	177	);
%import(day=	178	);
%import(day=	179	);
%import(day=	180	);
%import(day=	181	);
%import(day=	182	);
%import(day=	183	);
%import(day=	184	);
%import(day=	185	);
%import(day=	186	);
%import(day=	187	);
%import(day=	188	);
%import(day=	189	);
%import(day=	190	);
%import(day=	191	);
%import(day=	192	);
%import(day=	193	);
%import(day=	194	);
%import(day=	195	);
%import(day=	196	);
%import(day=	197	);
%import(day=	198	);
%import(day=	199	);
%import(day=	200	);
%import(day=	201	);
%import(day=	202	);
%import(day=	203	);
%import(day=	204	);
%import(day=	205	);
%import(day=	206	);
%import(day=	207	);
%import(day=	208	);
%import(day=	209	);
%import(day=	210	);
%import(day=	211	);
%import(day=	212	);
%import(day=	213	);
%import(day=	214	);
%import(day=	215	);
%import(day=	216	);
%import(day=	217	);
%import(day=	218	);
%import(day=	219	);
%import(day=	220	);
%import(day=	221	);
%import(day=	222	);
%import(day=	223	);
%import(day=	224	);
%import(day=	225	);
%import(day=	226	);
%import(day=	227	);
%import(day=	228	);
%import(day=	229	);
%import(day=	230	);
%import(day=	231	);
%import(day=	232	);
%import(day=	233	);
%import(day=	234	);
%import(day=	235	);
%import(day=	236	);
%import(day=	237	);
%import(day=	238	);
%import(day=	239	);
%import(day=	240	);
%import(day=	241	);
%import(day=	242	);
%import(day=	243	);
%import(day=	244	);
%import(day=	245	);
%import(day=	246	);
%import(day=	247	);
%import(day=	248	);
%import(day=	249	);
%import(day=	250	);
%import(day=	251	);
%import(day=	252	);
%import(day=	253	);
%import(day=	254	);
%import(day=	255	);
%import(day=	256	);
%import(day=	257	);
%import(day=	258	);
%import(day=	259	);
%import(day=	260	);
%import(day=	261	);
%import(day=	262	);
%import(day=	263	);
%import(day=	264	);
%import(day=	265	);
%import(day=	266	);
%import(day=	267	);
%import(day=	268	);
%import(day=	269	);
%import(day=	270	);
%import(day=	271	);
%import(day=	272	);
%import(day=	273	);
%import(day=	274	);
%import(day=	275	);
%import(day=	276	);
%import(day=	277	);
%import(day=	278	);
%import(day=	279	);
%import(day=	280	);
%import(day=	281	);
%import(day=	282	);
%import(day=	283	);
%import(day=	284	);
%import(day=	285	);
%import(day=	286	);
%import(day=	287	);
%import(day=	288	);
%import(day=	289	);
%import(day=	290	);
%import(day=	291	);
%import(day=	292	);
%import(day=	293	);
%import(day=	294	);
%import(day=	295	);
%import(day=	296	);
%import(day=	297	);
%import(day=	298	);
%import(day=	299	);
%import(day=	300	);
%import(day=	301	);
%import(day=	302	);
%import(day=	303	);
%import(day=	304	);
%import(day=	305	);
%import(day=	306	);
%import(day=	307	);
%import(day=	308	);
%import(day=	309	);
%import(day=	310	);
%import(day=	311	);
%import(day=	312	);
%import(day=	313	);
%import(day=	314	);
%import(day=	315	);
%import(day=	316	);
%import(day=	317	);
%import(day=	318	);
%import(day=	319	);
%import(day=	320	);
%import(day=	321	);
%import(day=	322	);
%import(day=	323	);
%import(day=	324	);
%import(day=	325	);
%import(day=	326	);
%import(day=	327	);
%import(day=	328	);
%import(day=	329	);
%import(day=	330	);
%import(day=	331	);
%import(day=	332	);
%import(day=	333	);
%import(day=	334	);
%import(day=	335	);
%import(day=	336	);
%import(day=	337	);
%import(day=	338	);
%import(day=	339	);
%import(day=	340	);
%import(day=	341	);
%import(day=	342	);
%import(day=	343	);
%import(day=	344	);
%import(day=	345	);
%import(day=	346	);
%import(day=	347	);
%import(day=	348	);
%import(day=	349	);
%import(day=	350	);
%import(day=	351	);
%import(day=	352	);
%import(day=	353	);
%import(day=	354	);
%import(day=	355	);
%import(day=	356	);
%import(day=	357	);
%import(day=	358	);
%import(day=	359	);
%import(day=	360	);
%import(day=	361	);
%import(day=	362	);
%import(day=	363	);
%import(day=	364	);
%import(day=	365	);
%import(day=	366	);
		


/*CREATE FINAL AOD FILE WITH X (long_AOD), Y (lat_AOD) AND DELETE BAD AOD VALUES*/

Data AOD_Final_2009;
 set aod2009;
  	 if AOD >= 0.9     then delete;
	 if AOD <= 0.00001 then delete;
   keep Long_AOD Lat_AOD AOD Date guid ;
run;


proc sort data = AOD_Final_2009 nodupkey out = AOD_Final_2009; by date Long_aod Lat_aod; run;






/*export to dataset*/

libname aodf 'c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\2.Gather_data\FN001_AOD_full_dataset\' ;


data aodf.AOD_2009;
set AOD_Final_2009;
run; 

PROC IMPORT OUT= grid
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\3.Analysis\AN005_mod3\uniq_grid.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=YES;
	    DATAROW=2; 
		RUN;
		 

		
options mprint;
%macro import(day=);


PROC IMPORT OUT= T2010&day
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.4.Resources\DATA\MODIS USA\2010\MOD04_L2.A2010&day..table.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=NO;
	    DATAROW=2; 
		RUN;
		 

data T2010&day(drop=var1 var2 var3 var4 var5 var6);
set T2010&day;
date=Var2;
format DATE  DATE9.;
Long_aod=var4;
Lat_aod=var5;
AOD=var6/1000;
run; 


proc sort data = grid; by long_aod lat_aod   ;run;
proc sort data = T2010&day ; by long_aod lat_aod ;run;

data T2010&day;
merge grid(in=a) T2010&day (in=b)  ;
  by long_aod lat_aod;
    if a;
	run; 

PROC APPEND
     BASE = AOD2010
     DATA = T2010&day;
RUN ;

proc datasets lib = work; delete T2010&day; run;

%mend;

%import(day=	001	);
%import(day=	002	);
%import(day=	003	);
%import(day=	004	);
%import(day=	005	);
%import(day=	006	);
%import(day=	007	);
%import(day=	008	);
%import(day=	009	);
%import(day=	010	);
%import(day=	011	);
%import(day=	012	);
%import(day=	013	);
%import(day=	014	);
%import(day=	015	);
%import(day=	016	);
%import(day=	017	);
%import(day=	018	);
%import(day=	019	);
%import(day=	020	);
%import(day=	021	);
%import(day=	022	);
%import(day=	023	);
%import(day=	024	);
%import(day=	025	);
%import(day=	026	);
%import(day=	027	);
%import(day=	028	);
%import(day=	029	);
%import(day=	030	);
%import(day=	031	);
%import(day=	032	);
%import(day=	033	);
%import(day=	034	);
%import(day=	035	);
%import(day=	036	);
%import(day=	037	);
%import(day=	038	);
%import(day=	039	);
%import(day=	040	);
%import(day=	041	);
%import(day=	042	);
%import(day=	043	);
%import(day=	044	);
%import(day=	045	);
%import(day=	046	);
%import(day=	047	);
%import(day=	048	);
%import(day=	049	);
%import(day=	050	);
%import(day=	051	);
%import(day=	052	);
%import(day=	053	);
%import(day=	054	);
%import(day=	055	);
%import(day=	056	);
%import(day=	057	);
%import(day=	058	);
%import(day=	059	);
%import(day=	060	);
%import(day=	061	);
%import(day=	062	);
%import(day=	063	);
%import(day=	064	);
%import(day=	065	);
%import(day=	066	);
%import(day=	067	);
%import(day=	068	);
%import(day=	069	);
%import(day=	070	);
%import(day=	071	);
%import(day=	072	);
%import(day=	073	);
%import(day=	074	);
%import(day=	075	);
%import(day=	076	);
%import(day=	077	);
%import(day=	078	);
%import(day=	079	);
%import(day=	080	);
%import(day=	081	);
%import(day=	082	);
%import(day=	083	);
%import(day=	084	);
%import(day=	085	);
%import(day=	086	);
%import(day=	087	);
%import(day=	088	);
%import(day=	089	);
%import(day=	090	);
%import(day=	091	);
%import(day=	092	);
%import(day=	093	);
%import(day=	094	);
%import(day=	095	);
%import(day=	096	);
%import(day=	097	);
%import(day=	098	);
%import(day=	099	);
%import(day=	100	);
%import(day=	101	);
%import(day=	102	);
%import(day=	103	);
%import(day=	104	);
%import(day=	105	);
%import(day=	106	);
%import(day=	107	);
%import(day=	108	);
%import(day=	109	);
%import(day=	110	);
%import(day=	111	);
%import(day=	112	);
%import(day=	113	);
%import(day=	114	);
%import(day=	115	);
%import(day=	116	);
%import(day=	117	);
%import(day=	118	);
%import(day=	119	);
%import(day=	120	);
%import(day=	121	);
%import(day=	122	);
%import(day=	123	);
%import(day=	124	);
%import(day=	125	);
%import(day=	126	);
%import(day=	127	);
%import(day=	128	);
%import(day=	129	);
%import(day=	130	);
%import(day=	131	);
%import(day=	132	);
%import(day=	133	);
%import(day=	134	);
%import(day=	135	);
%import(day=	136	);
%import(day=	137	);
%import(day=	138	);
%import(day=	139	);
%import(day=	140	);
%import(day=	141	);
%import(day=	142	);
%import(day=	143	);
%import(day=	144	);
%import(day=	145	);
%import(day=	146	);
%import(day=	147	);
%import(day=	148	);
%import(day=	149	);
%import(day=	150	);
%import(day=	151	);
%import(day=	152	);
%import(day=	153	);
%import(day=	154	);
%import(day=	155	);
%import(day=	156	);
%import(day=	157	);
%import(day=	158	);
%import(day=	159	);
%import(day=	160	);
%import(day=	161	);
%import(day=	162	);
%import(day=	163	);
%import(day=	164	);
%import(day=	165	);
%import(day=	166	);
%import(day=	167	);
%import(day=	168	);
%import(day=	169	);
%import(day=	170	);
%import(day=	171	);
%import(day=	172	);
%import(day=	173	);
%import(day=	174	);
%import(day=	175	);
%import(day=	176	);
%import(day=	177	);
%import(day=	178	);
%import(day=	179	);
%import(day=	180	);
%import(day=	181	);
%import(day=	182	);
%import(day=	183	);
%import(day=	184	);
%import(day=	185	);
%import(day=	186	);
%import(day=	187	);
%import(day=	188	);
%import(day=	189	);
%import(day=	190	);
%import(day=	191	);
%import(day=	192	);
%import(day=	193	);
%import(day=	194	);
%import(day=	195	);
%import(day=	196	);
%import(day=	197	);
%import(day=	198	);
%import(day=	199	);
%import(day=	200	);
%import(day=	201	);
%import(day=	202	);
%import(day=	203	);
%import(day=	204	);
%import(day=	205	);
%import(day=	206	);
%import(day=	207	);
%import(day=	208	);
%import(day=	209	);
%import(day=	210	);
%import(day=	211	);
%import(day=	212	);
%import(day=	213	);
%import(day=	214	);
%import(day=	215	);
%import(day=	216	);
%import(day=	217	);
%import(day=	218	);
%import(day=	219	);
%import(day=	220	);
%import(day=	221	);
%import(day=	222	);
%import(day=	223	);
%import(day=	224	);
%import(day=	225	);
%import(day=	226	);
%import(day=	227	);
%import(day=	228	);
%import(day=	229	);
%import(day=	230	);
%import(day=	231	);
%import(day=	232	);
%import(day=	233	);
%import(day=	234	);
%import(day=	235	);
%import(day=	236	);
%import(day=	237	);
%import(day=	238	);
%import(day=	239	);
%import(day=	240	);
%import(day=	241	);
%import(day=	242	);
%import(day=	243	);
%import(day=	244	);
%import(day=	245	);
%import(day=	246	);
%import(day=	247	);
%import(day=	248	);
%import(day=	249	);
%import(day=	250	);
%import(day=	251	);
%import(day=	252	);
%import(day=	253	);
%import(day=	254	);
%import(day=	255	);
%import(day=	256	);
%import(day=	257	);
%import(day=	258	);
%import(day=	259	);
%import(day=	260	);
%import(day=	261	);
%import(day=	262	);
%import(day=	263	);
%import(day=	264	);
%import(day=	265	);
%import(day=	266	);
%import(day=	267	);
%import(day=	268	);
%import(day=	269	);
%import(day=	270	);
%import(day=	271	);
%import(day=	272	);
%import(day=	273	);
%import(day=	274	);
%import(day=	275	);
%import(day=	276	);
%import(day=	277	);
%import(day=	278	);
%import(day=	279	);
%import(day=	280	);
%import(day=	281	);
%import(day=	282	);
%import(day=	283	);
%import(day=	284	);
%import(day=	285	);
%import(day=	286	);
%import(day=	287	);
%import(day=	288	);
%import(day=	289	);
%import(day=	290	);
%import(day=	291	);
%import(day=	292	);
%import(day=	293	);
%import(day=	294	);
%import(day=	295	);
%import(day=	296	);
%import(day=	297	);
%import(day=	298	);
%import(day=	299	);
%import(day=	300	);
%import(day=	301	);
%import(day=	302	);
%import(day=	303	);
%import(day=	304	);
%import(day=	305	);
%import(day=	306	);
%import(day=	307	);
%import(day=	308	);
%import(day=	309	);
%import(day=	310	);
%import(day=	311	);
%import(day=	312	);
%import(day=	313	);
%import(day=	314	);
%import(day=	315	);
%import(day=	316	);
%import(day=	317	);
%import(day=	318	);
%import(day=	319	);
%import(day=	320	);
%import(day=	321	);
%import(day=	322	);
%import(day=	323	);
%import(day=	324	);
%import(day=	325	);
%import(day=	326	);
%import(day=	327	);
%import(day=	328	);
%import(day=	329	);
%import(day=	330	);
%import(day=	331	);
%import(day=	332	);
%import(day=	333	);
%import(day=	334	);
%import(day=	335	);
%import(day=	336	);
%import(day=	337	);
%import(day=	338	);
%import(day=	339	);
%import(day=	340	);
%import(day=	341	);
%import(day=	342	);
%import(day=	343	);
%import(day=	344	);
%import(day=	345	);
%import(day=	346	);
%import(day=	347	);
%import(day=	348	);
%import(day=	349	);
%import(day=	350	);
%import(day=	351	);
%import(day=	352	);
%import(day=	353	);
%import(day=	354	);
%import(day=	355	);
%import(day=	356	);
%import(day=	357	);
%import(day=	358	);
%import(day=	359	);
%import(day=	360	);
%import(day=	361	);
%import(day=	362	);
%import(day=	363	);
%import(day=	364	);
%import(day=	365	);
%import(day=	366	);
		


/*CREATE FINAL AOD FILE WITH X (long_AOD), Y (lat_AOD) AND DELETE BAD AOD VALUES*/

Data AOD_Final_2010;
 set aod2010;
    	 if AOD >= 0.9     then delete;
	 if AOD <= 0.00001 then delete;
   keep Long_AOD Lat_AOD AOD Date guid ;
run;


proc sort data = AOD_Final_2010 nodupkey out = AOD_Final_2010; by date Long_aod Lat_aod; run;


/*export to dataset*/

libname aodf 'c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\2.Gather_data\FN001_AOD_full_dataset\' ;


data aodf.AOD_2010;
set AOD_Final_2010;
run; 

PROC IMPORT OUT= grid
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\3.Analysis\AN005_mod3\uniq_grid.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=YES;
	    DATAROW=2; 
		RUN;
		 

		
options mprint;
%macro import(day=);


PROC IMPORT OUT= T2011&day
  DATAFILE= "c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.4.Resources\DATA\MODIS USA\2011\MOD04_L2.A2011&day..table.csv" 
    DBMS=CSV REPLACE;
	  GETNAMES=NO;
	    DATAROW=2; 
		RUN;
		 

data T2011&day(drop=var1 var2 var3 var4 var5 var6);
set T2011&day;
date=Var2;
format DATE  DATE9.;
Long_aod=var4;
Lat_aod=var5;
AOD=var6/1000;
run; 


proc sort data = grid; by long_aod lat_aod   ;run;
proc sort data = T2011&day ; by long_aod lat_aod ;run;

data T2011&day;
merge grid(in=a) T2011&day (in=b)  ;
  by long_aod lat_aod;
    if a;
	run; 

PROC APPEND
     BASE = AOD2011
     DATA = T2011&day;
RUN ;

proc datasets lib = work; delete T2011&day; run;

%mend;

%import(day=	001	);
%import(day=	002	);
%import(day=	003	);
%import(day=	004	);
%import(day=	005	);
%import(day=	006	);
%import(day=	007	);
%import(day=	008	);
%import(day=	009	);
%import(day=	010	);
%import(day=	011	);
%import(day=	012	);
%import(day=	013	);
%import(day=	014	);
%import(day=	015	);
%import(day=	016	);
%import(day=	017	);
%import(day=	018	);
%import(day=	019	);
%import(day=	020	);
%import(day=	021	);
%import(day=	022	);
%import(day=	023	);
%import(day=	024	);
%import(day=	025	);
%import(day=	026	);
%import(day=	027	);
%import(day=	028	);
%import(day=	029	);
%import(day=	030	);
%import(day=	031	);
%import(day=	032	);
%import(day=	033	);
%import(day=	034	);
%import(day=	035	);
%import(day=	036	);
%import(day=	037	);
%import(day=	038	);
%import(day=	039	);
%import(day=	040	);
%import(day=	041	);
%import(day=	042	);
%import(day=	043	);
%import(day=	044	);
%import(day=	045	);
%import(day=	046	);
%import(day=	047	);
%import(day=	048	);
%import(day=	049	);
%import(day=	050	);
%import(day=	051	);
%import(day=	052	);
%import(day=	053	);
%import(day=	054	);
%import(day=	055	);
%import(day=	056	);
%import(day=	057	);
%import(day=	058	);
%import(day=	059	);
%import(day=	060	);
%import(day=	061	);
%import(day=	062	);
%import(day=	063	);
%import(day=	064	);
%import(day=	065	);
%import(day=	066	);
%import(day=	067	);
%import(day=	068	);
%import(day=	069	);
%import(day=	070	);
%import(day=	071	);
%import(day=	072	);
%import(day=	073	);
%import(day=	074	);
%import(day=	075	);
%import(day=	076	);
%import(day=	077	);
%import(day=	078	);
%import(day=	079	);
%import(day=	080	);
%import(day=	081	);
%import(day=	082	);
%import(day=	083	);
%import(day=	084	);
%import(day=	085	);
%import(day=	086	);
%import(day=	087	);
%import(day=	088	);
%import(day=	089	);
%import(day=	090	);
%import(day=	091	);
%import(day=	092	);
%import(day=	093	);
%import(day=	094	);
%import(day=	095	);
%import(day=	096	);
%import(day=	097	);
%import(day=	098	);
%import(day=	099	);
%import(day=	100	);
%import(day=	101	);
%import(day=	102	);
%import(day=	103	);
%import(day=	104	);
%import(day=	105	);
%import(day=	106	);
%import(day=	107	);
%import(day=	108	);
%import(day=	109	);
%import(day=	110	);
%import(day=	111	);
%import(day=	112	);
%import(day=	113	);
%import(day=	114	);
%import(day=	115	);
%import(day=	116	);
%import(day=	117	);
%import(day=	118	);
%import(day=	119	);
%import(day=	120	);
%import(day=	121	);
%import(day=	122	);
%import(day=	123	);
%import(day=	124	);
%import(day=	125	);
%import(day=	126	);
%import(day=	127	);
%import(day=	128	);
%import(day=	129	);
%import(day=	130	);
%import(day=	131	);
%import(day=	132	);
%import(day=	133	);
%import(day=	134	);
%import(day=	135	);
%import(day=	136	);
%import(day=	137	);
%import(day=	138	);
%import(day=	139	);
%import(day=	140	);
%import(day=	141	);
%import(day=	142	);
%import(day=	143	);
%import(day=	144	);
%import(day=	145	);
%import(day=	146	);
%import(day=	147	);
%import(day=	148	);
%import(day=	149	);
%import(day=	150	);
%import(day=	151	);
%import(day=	152	);
%import(day=	153	);
%import(day=	154	);
%import(day=	155	);
%import(day=	156	);
%import(day=	157	);
%import(day=	158	);
%import(day=	159	);
%import(day=	160	);
%import(day=	161	);
%import(day=	162	);
%import(day=	163	);
%import(day=	164	);
%import(day=	165	);
%import(day=	166	);
%import(day=	167	);
%import(day=	168	);
%import(day=	169	);
%import(day=	170	);
%import(day=	171	);
%import(day=	172	);
%import(day=	173	);
%import(day=	174	);
%import(day=	175	);
%import(day=	176	);
%import(day=	177	);
%import(day=	178	);
%import(day=	179	);
%import(day=	180	);
%import(day=	181	);
%import(day=	182	);
%import(day=	183	);
%import(day=	184	);
%import(day=	185	);
%import(day=	186	);
%import(day=	187	);
%import(day=	188	);
%import(day=	189	);
%import(day=	190	);
%import(day=	191	);
%import(day=	192	);
%import(day=	193	);
%import(day=	194	);
%import(day=	195	);
%import(day=	196	);
%import(day=	197	);
%import(day=	198	);
%import(day=	199	);
%import(day=	200	);
%import(day=	201	);
%import(day=	202	);
%import(day=	203	);
%import(day=	204	);
%import(day=	205	);
%import(day=	206	);
%import(day=	207	);
%import(day=	208	);
%import(day=	209	);
%import(day=	210	);
%import(day=	211	);
%import(day=	212	);
%import(day=	213	);
%import(day=	214	);
%import(day=	215	);
%import(day=	216	);
%import(day=	217	);
%import(day=	218	);
%import(day=	219	);
%import(day=	220	);
%import(day=	221	);
%import(day=	222	);
%import(day=	223	);
%import(day=	224	);
%import(day=	225	);
%import(day=	226	);
%import(day=	227	);
%import(day=	228	);
%import(day=	229	);
%import(day=	230	);
%import(day=	231	);
%import(day=	232	);
%import(day=	233	);
%import(day=	234	);
%import(day=	235	);
%import(day=	236	);
%import(day=	237	);
%import(day=	238	);
%import(day=	239	);
%import(day=	240	);
%import(day=	241	);
%import(day=	242	);
%import(day=	243	);
%import(day=	244	);
%import(day=	245	);
%import(day=	246	);
%import(day=	247	);
%import(day=	248	);
%import(day=	249	);
%import(day=	250	);
%import(day=	251	);
%import(day=	252	);
%import(day=	253	);
%import(day=	254	);
%import(day=	255	);
%import(day=	256	);
%import(day=	257	);
%import(day=	258	);
%import(day=	259	);
%import(day=	260	);
%import(day=	261	);
%import(day=	262	);
%import(day=	263	);
%import(day=	264	);
%import(day=	265	);
%import(day=	266	);
%import(day=	267	);
%import(day=	268	);
%import(day=	269	);
%import(day=	270	);
%import(day=	271	);
%import(day=	272	);
%import(day=	273	);
%import(day=	274	);
%import(day=	275	);
%import(day=	276	);
%import(day=	277	);
%import(day=	278	);
%import(day=	279	);
%import(day=	280	);
%import(day=	281	);
%import(day=	282	);
%import(day=	283	);
%import(day=	284	);
%import(day=	285	);
%import(day=	286	);
%import(day=	287	);
%import(day=	288	);
%import(day=	289	);
%import(day=	290	);
%import(day=	291	);
%import(day=	292	);
%import(day=	293	);
%import(day=	294	);
%import(day=	295	);
%import(day=	296	);
%import(day=	297	);
%import(day=	298	);
%import(day=	299	);
%import(day=	300	);
%import(day=	301	);
%import(day=	302	);
%import(day=	303	);
%import(day=	304	);
%import(day=	305	);
%import(day=	306	);
%import(day=	307	);
%import(day=	308	);
%import(day=	309	);
%import(day=	310	);
%import(day=	311	);
%import(day=	312	);
%import(day=	313	);
%import(day=	314	);
%import(day=	315	);
%import(day=	316	);
%import(day=	317	);
%import(day=	318	);
%import(day=	319	);
%import(day=	320	);
%import(day=	321	);
%import(day=	322	);
%import(day=	323	);
%import(day=	324	);
%import(day=	325	);
%import(day=	326	);
%import(day=	327	);
%import(day=	328	);
%import(day=	329	);
%import(day=	330	);
%import(day=	331	);
%import(day=	332	);
%import(day=	333	);
%import(day=	334	);
%import(day=	335	);
%import(day=	336	);
%import(day=	337	);
%import(day=	338	);
%import(day=	339	);
%import(day=	340	);
%import(day=	341	);
%import(day=	342	);
%import(day=	343	);
%import(day=	344	);
%import(day=	345	);
%import(day=	346	);
%import(day=	347	);
%import(day=	348	);
%import(day=	349	);
%import(day=	350	);
%import(day=	351	);
%import(day=	352	);
%import(day=	353	);
%import(day=	354	);
%import(day=	355	);
%import(day=	356	);
%import(day=	357	);
%import(day=	358	);
%import(day=	359	);
%import(day=	360	);
%import(day=	361	);
%import(day=	362	);
%import(day=	363	);
%import(day=	364	);
%import(day=	365	);
%import(day=	366	);
		


/*CREATE FINAL AOD FILE WITH X (long_AOD), Y (lat_AOD) AND DELETE BAD AOD VALUES*/

Data AOD_Final_2011;
 set aod2011;
    	 if AOD >= 0.9     then delete;
	 if AOD <= 0.00001 then delete;
   keep Long_AOD Lat_AOD AOD Date guid ;
run;


proc sort data = AOD_Final_2011 nodupkey out = AOD_Final_2011; by date Long_aod Lat_aod; run;


/*export to dataset*/

libname aodf 'c:\Users\ekloog\Documents\$Doc\3.PostDoc\3.1.Projetcs\3.1.1.NE_PM_MODELS\3.1.1.4.Work\2.Gather_data\FN001_AOD_full_dataset\' ;

data aodf.AOD_2011;
 set AOD_Final_2011;
run; 

